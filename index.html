<!DOCTYPE html>
<html>

<head>
    <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@v0.182.0/build/three.module.js",
        "three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.182.0/examples/jsm/"
      }
    }
    </script>
</head>

<body style="margin:0; overflow: hidden">
    <script type="module">
        import * as THREE from 'three'

        const renderer = new THREE.WebGLRenderer()
        renderer.setSize(window.innerWidth, window.innerHeight)
        document.body.appendChild(renderer.domElement)

        const scene = new THREE.Scene()

        const camera = new THREE.PerspectiveCamera(120, window.innerWidth / window.innerHeight, 0.1, 100)
        camera.position.set(0, 1, 3)
        camera.lookAt(0, 0, 0)

        const axes = new THREE.AxesHelper(1)
        scene.add(axes)

        const loader = new THREE.TextureLoader()
        loader.load(
            'equi.png',
            (tex) => {
                tex.mapping = THREE.EquirectangularReflectionMapping
                scene.background = tex
                animate()
            }
        )

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight
            camera.updateProjectionMatrix()
            renderer.setSize(window.innerWidth, window.innerHeight)
        })

        let keyDown = {}
        window.keyDown = keyDown
        window.addEventListener('keydown', e => keyDown[e.code] = true);
        window.addEventListener('keyup', e => keyDown[e.code] = false);

        function animate() {
            requestAnimationFrame(animate)
            axes.rotation.x += (!!keyDown["KeyA"] - !!keyDown["KeyD"]) * 0.02
            axes.rotation.y += (!!keyDown["KeyW"] - !!keyDown["KeyS"]) * 0.02
            axes.rotation.z += (!!keyDown["KeyQ"] - !!keyDown["KeyE"]) * 0.02
            scene.backgroundRotation.copy(axes.rotation)
            renderer.render(scene, camera)
        }
    </script>
</body>

</html>
